# setup
library(tidyverse)
library(rvest)
library(nbastatR)
library(lubridate)
library(janitor)
library(heapsofpapers)
library(arrow)
Sys.setenv("VROOM_CONNECTION_SIZE" = 300000)
# Data from nbaR
gamedata <- clean_names(game_logs(seasons = 2012:2022, season_types = c("Regular Season", "Playoffs")))
# Save raw
write_parquet(x = gamedata, sink ="data/raw/gamedata.parquet")

# 
season_data <- clean_names(nbastatR::seasons_players(seasons = 2012:2022))
# Save raw
write_parquet(x = season_data, sink ="data/raw/seasondata.parquet")

# Dowload Rosters
rosters <- clean_names(seasons_rosters(seasons = 2012:2022))
#save raw
write_parquet(x = rosters, sink ="data/raw/rosters.parquet")

